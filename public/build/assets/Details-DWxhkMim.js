import{i as x,r as f,o as K,w as y,c as r,a as i,b as s,d as h,t as c,F as j,e as S,f as L}from"./app-SjD42TUq.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */var q;(function(o){o.pop="pop",o.push="push"})(q||(q={}));var R;(function(o){o.back="back",o.forward="forward",o.unknown=""})(R||(R={}));var F;(function(o){o[o.aborted=4]="aborted",o[o.cancelled=8]="cancelled",o[o.duplicated=16]="duplicated"})(F||(F={}));const V=Symbol(""),z=Symbol("");function N(){return x(V)}function U(o){return x(z)}const Y={class:"safe-area"},G={class:"scroll-container"},J=["disabled"],W={key:0,class:"status-box hired"},Q={key:1,class:"status-box rejected"},X={key:2,class:"status-box shortlisted"},Z={key:3,class:"card"},T={class:"card-row"},ee={class:"card-row"},te={key:4,class:"requirements"},se={class:"requirement-type"},ne={key:0,class:"uploaded-files"},oe=["onClick"],ae={__name:"Details",setup(o){async function D(e){return fetch(`/api/applications/${e}`).then(t=>t.json())}async function C(e){return fetch("/api/requirements",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requirements:e})}).then(t=>t.json())}async function A(e,t){return fetch(`/api/user-files?jobId=${e}&userId=${t}`).then(a=>a.json())}function m(e,t){console.error(`Error in ${t}:`,e)}function B(e){return e?parseFloat(e).toLocaleString("en-PH",{style:"currency",currency:"PHP"}):"0.00"}function I(e){return e<1024?e+" B":e<1024*1024?(e/1024).toFixed(1)+" KB":(e/(1024*1024)).toFixed(1)+" MB"}function P(e,t){window.open(e,"_blank")}const $=U(),H=N(),k=$.params.id,n=f({}),d=f([]),_=f({}),v=f(!1),b=f(!1),w=async()=>{v.value=!0;try{const e=await D(k);n.value=e}catch(e){alert("Something went wrong fetching the data."),m(e,"Fetch Application")}finally{v.value=!1,b.value=!1}};K(w),y(()=>{var e;return(e=n.value.details)==null?void 0:e.name},e=>{e&&(document.title=`Application - ${e}`)}),y(()=>{var e;return(e=n.value.job)==null?void 0:e.requirements},async e=>{if(e)try{const t=JSON.parse(e),a=await C(t);d.value=a}catch(t){m(t,"Fetch Requirements")}}),y([d,()=>{var e;return(e=n.value.details)==null?void 0:e.id}],async([e,t])=>{if(e.length&&t)try{const a={},l=await A(n.value.job.id,t);for(const u of l.files)a[u.RequirementID]||(a[u.RequirementID]={files:[]}),a[u.RequirementID].files.push(u);_.value=a}catch(a){m(a,"Fetch Files")}});const M=async()=>{b.value=!0,await w(),b.value=!1},E=()=>{H.push({name:"ContractScreen",params:{id:n.value.job.contract.id,BidID:k,jobId:n.value.job.id,UserID:n.value.details.id}})};return(e,t)=>{var a;return i(),r("div",Y,[s("div",G,[s("button",{onClick:M,disabled:v.value,class:"refresh-btn"},c(v.value?"Refreshing...":"Refresh"),9,J),n.value.ApplicationStatus==="Hired"?(i(),r("div",W,t[0]||(t[0]=[s("span",{class:"icon"},"✔️",-1),s("p",{class:"status-text green"},"Congratulations! You have been hired.",-1)]))):n.value.ApplicationStatus==="Rejected"?(i(),r("div",Q,t[1]||(t[1]=[s("span",{class:"icon"},"❌",-1),s("p",{class:"status-text red"},"We regret to inform you that your application has been rejected.",-1)]))):n.value.ApplicationStatus==="shortlisted"?(i(),r("div",X,t[2]||(t[2]=[s("span",{class:"icon"},"⭐",-1),s("p",{class:"status-text orange"},"Good news! You have been shortlisted for this position.",-1)]))):h("",!0),n.value.job?(i(),r("div",Z,[s("h2",null,c(n.value.job.title),1),s("div",T,[t[3]||(t[3]=s("span",null,"Bid Amount:",-1)),s("strong",null,c(B(n.value.bid_amount)),1)]),s("div",ee,[t[4]||(t[4]=s("span",null,"Proposed Duration:",-1)),s("strong",null,c(n.value.proposed_duration),1)])])):h("",!0),d.value.length&&d.value.some(l=>l.type!=="None")?(i(),r("section",te,[t[5]||(t[5]=s("h3",null,"Requirements",-1)),(i(!0),r(j,null,S(d.value,(l,u)=>{var g;return i(),r("div",{key:u,class:"requirement-card"},[s("div",se,c(l.type),1),(g=_.value[l.id])!=null&&g.files?(i(),r("div",ne,[(i(!0),r(j,null,S(_.value[l.id].files,p=>(i(),r("div",{key:p.id,class:"file-row"},[s("a",{href:"#",onClick:L(re=>P(p.FilePath,p.FileName),["prevent"]),class:"file-link"},c(p.FileName),9,oe),s("small",null,c(I(p.size)),1)]))),128))])):h("",!0)])}),128))])):h("",!0),(a=n.value.job)!=null&&a.contract&&n.value.ApplicationStatus==="Hired"?(i(),r("button",{key:5,class:"btn btn-success",onClick:E}," View Contract ")):h("",!0)])])}}},ce=O(ae,[["__scopeId","data-v-d6153527"]]);export{ce as default};
